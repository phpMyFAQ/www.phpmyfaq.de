# Ensure Apache serves index.html for directories and never prefers index.txt

# Prefer index.html as the directory index
DirectoryIndex index.html

# Disable MultiViews (content negotiation on filename) which could pick index.txt
<IfModule mod_negotiation.c>
  Options -MultiViews
</IfModule>

# Map directory requests to index.html explicitly as a safety net
<IfModule mod_rewrite.c>
  RewriteEngine On
  # If the request is a directory, serve its index.html
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^(.*/)$ $1index.html [L]

  # Map /api/news/* to /api/news/*.json (clean URLs for API)
  RewriteCond %{REQUEST_URI} ^/api/news/([^/]+)/?$
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{DOCUMENT_ROOT}/api/news/%1.json -f
  RewriteRule ^api/news/([^/]+)/?$ /api/news/$1.json [L]
</IfModule>

# JSON API headers
<FilesMatch "\.json$">
  <IfModule mod_headers.c>
    Header set Content-Type "application/json"
    Header set Access-Control-Allow-Origin "*"
  </IfModule>
</FilesMatch>

# Do NOT block index.txt; Next.js may fetch RSC flight data from it.
